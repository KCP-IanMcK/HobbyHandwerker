<div id="createProfileContainer" class="create-profile-container">
  <button id="closeCreateProfileButton" (click)="closePopup()" style="float: right; background: none; border: none; color: #666; font-size: 1.5rem; padding: 0; margin: 0; cursor: pointer;">&times;</button>
  <h2>Neues Profil erstellen</h2>

  <form (ngSubmit)="submitForm()" #profileForm="ngForm" novalidate>

    <label for="username">Name:</label>
    <input
      type="text"
      id="username"
      name="username"
      required
      [(ngModel)]="profile.username"
      #username="ngModel"
      [class.invalid]="username.invalid && username.touched"
      placeholder="Dein Name"
    />
    <div *ngIf="username.invalid && username.touched" class="error-msg">
      Name ist Pflicht.
    </div>

    <label for="email">Email:</label>
    <input
      type="email"
      id="email"
      name="email"
      required
      email
      [(ngModel)]="profile.email"
      #email="ngModel"
      [class.invalid]="email.invalid && email.touched"
      placeholder="beispiel@mail.de"
    />
    <div *ngIf="email.invalid && email.touched" class="error-msg">
      Bitte gültige Email eingeben.
    </div>

    <label for="password">Passwort:</label>
    <input
      type="password"
      id="password"
      name="password"
      required
      minlength="8"
      [(ngModel)]="profile.password"
      #password="ngModel"
      (input)="checkPasswordStrength()"
      (focus)="showPasswordMeter = true"
      [class.invalid]="password.invalid && password.touched"
      placeholder="Dein Passwort"
    />

    <!-- Only show strength meter when user focuses on password field -->
    <div *ngIf="showPasswordMeter">
      <div class="strength-meter">
        <div
          class="strength-bar"
          [style.width.%]="strengthScore * 25"
          [style.background-color]="strengthColor">
        </div>
      </div>

      <p class="strength-text" [style.color]="strengthColor">{{ strengthText }}</p>

      <ul class="password-requirements">
        <li [class.valid]="hasMinLength">Mindestens 12 Zeichen</li>
        <li [class.valid]="hasUpperCase">Großbuchstabe</li>
        <li [class.valid]="hasLowerCase">Kleinbuchstabe</li>
        <li [class.valid]="hasNumber">Zahl</li>
        <li [class.valid]="hasSpecialChar">Sonderzeichen (!#$...)</li>
      </ul>
    </div>

    <div *ngIf="password.invalid && password.touched" class="error-msg">
      Passwort ist Pflicht.
    </div>

    <label for="avatarUrl">Profilbild URL:</label>
    <input
      type="url"
      id="avatarUrl"
      name="avatarUrl"
      [(ngModel)]="profile.avatarUrl"
      placeholder="https://example.com/avatar.jpg"
    />

    <button type="submit">Profil erstellen</button>
  </form>

  <p *ngIf="message" class="message">{{ message }}</p>
</div>
